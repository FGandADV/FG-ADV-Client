import base64;exec(base64.b64decode('aW1wb3J0IHJlcXVlc3RzCmltcG9ydCBzb2NrZXQKaW1wb3J0IHRpbWUKaW1wb3J0IGJhc2U2NAppbXBvcnQgcmUKZnJvbSB1cmxsaWIucGFyc2UgaW1wb3J0IHVybHBhcnNlLCBxdW90ZSwgdXJsam9pbgpmcm9tIEJydWhQZW50ZXN0LnV0aWxzIGltcG9ydCBnZXRfcmFuZG9tX3VzZXJfYWdlbnQKCgpjbGFzcyBFeHBsb2l0U2Nhbm5lcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLnNlc3MgPSByZXF1ZXN0cy5TZXNzaW9uKCkKICAgICAgICBzZWxmLnNlc3MuaGVhZGVycy51cGRhdGUoeydVc2VyLUFnZW50JzogZ2V0X3JhbmRvbV91c2VyX2FnZW50KCl9KQoKICAgIGRlZiBoaXRfZW5kcG9pbnQoc2VsZiwgdXJsLCBtZXRob2Q9IkdFVCIsIGRhdGE9Tm9uZSwgaGVhZGVycz1Ob25lLCBmb2xsb3dfcmVkaXJlY3RzPVRydWUsIHZlcmlmeT1GYWxzZSwgdGltZW91dD0xMCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBicm93c2VyID0geydVc2VyLUFnZW50JzogZ2V0X3JhbmRvbV91c2VyX2FnZW50KCl9CiAgICAgICAgICAgIGlmIGhlYWRlcnM6CiAgICAgICAgICAgICAgICBicm93c2VyLnVwZGF0ZShoZWFkZXJzKQoKICAgICAgICAgICAgaWYgbWV0aG9kLnVwcGVyKCkgPT0gIkdFVCI6CiAgICAgICAgICAgICAgICByZXNwID0gc2VsZi5zZXNzLmdldCgKICAgICAgICAgICAgICAgICAgICB1cmwsCiAgICAgICAgICAgICAgICAgICAgaGVhZGVycz1icm93c2VyLAogICAgICAgICAgICAgICAgICAgIGFsbG93X3JlZGlyZWN0cz1mb2xsb3dfcmVkaXJlY3RzLAogICAgICAgICAgICAgICAgICAgIHZlcmlmeT12ZXJpZnksCiAgICAgICAgICAgICAgICAgICAgdGltZW91dD10aW1lb3V0CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGVsaWYgbWV0aG9kLnVwcGVyKCkgPT0gIlBPU1QiOgogICAgICAgICAgICAgICAgcmVzcCA9IHNlbGYuc2Vzcy5wb3N0KAogICAgICAgICAgICAgICAgICAgIHVybCwKICAgICAgICAgICAgICAgICAgICBkYXRhPWRhdGEsCiAgICAgICAgICAgICAgICAgICAgaGVhZGVycz1icm93c2VyLAogICAgICAgICAgICAgICAgICAgIGFsbG93X3JlZGlyZWN0cz1mb2xsb3dfcmVkaXJlY3RzLAogICAgICAgICAgICAgICAgICAgIHZlcmlmeT12ZXJpZnksCiAgICAgICAgICAgICAgICAgICAgdGltZW91dD10aW1lb3V0CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIGVsaWYgbWV0aG9kLnVwcGVyKCkgPT0gIkhFQUQiOgogICAgICAgICAgICAgICAgcmVzcCA9IHNlbGYuc2Vzcy5oZWFkKAogICAgICAgICAgICAgICAgICAgIHVybCwKICAgICAgICAgICAgICAgICAgICBoZWFkZXJzPWJyb3dzZXIsCiAgICAgICAgICAgICAgICAgICAgYWxsb3dfcmVkaXJlY3RzPWZvbGxvd19yZWRpcmVjdHMsCiAgICAgICAgICAgICAgICAgICAgdmVyaWZ5PXZlcmlmeSwKICAgICAgICAgICAgICAgICAgICB0aW1lb3V0PXRpbWVvdXQKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJldHVybiBOb25lCgogICAgICAgICAgICByZXR1cm4gcmVzcAogICAgICAgIGV4Y2VwdCByZXF1ZXN0cy5SZXF1ZXN0RXhjZXB0aW9uOgogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBwd25fc3FsX2luamVjdGlvbihzZWxmLCBlbmRwb2ludCk6CiAgICAgICAgdXJsID0gZW5kcG9pbnRbInVybCJdCiAgICAgICAgcGFyYW0gPSBlbmRwb2ludFsicGFyYW0iXQogICAgICAgIG1ldGhvZCA9IGVuZHBvaW50LmdldCgidHlwZSIsICJHRVQiKQoKICAgICAgICBwYXlsb2FkID0gIicgVU5JT04gU0VMRUNUIDEsMiwzLDQsNSw2LDcsOCw5LDEwIC0tIgogICAgICAgIGlmIG1ldGhvZCA9PSAiR0VUIjoKICAgICAgICAgICAgYmFzZV91cmwgPSB1cmwuc3BsaXQoJz8nKVswXQogICAgICAgICAgICB0ZXN0X3VybCA9IGYie2Jhc2VfdXJsfT97cGFyYW19PXtxdW90ZShwYXlsb2FkKX0iCiAgICAgICAgICAgIHJlc3AgPSBzZWxmLmhpdF9lbmRwb2ludCh0ZXN0X3VybCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBmb3JtX2RhdGEgPSB7cGFyYW06IHBheWxvYWR9CiAgICAgICAgICAgIHJlc3AgPSBzZWxmLmhpdF9lbmRwb2ludCh1cmwsIG1ldGhvZD0iUE9TVCIsIGRhdGE9Zm9ybV9kYXRhKQoKICAgICAgICBpZiByZXNwIGFuZCBhbnkoc3RyKGkpIGluIHJlc3AudGV4dCBmb3IgaSBpbiByYW5nZSgxLCAxMSkpOgogICAgICAgICAgICBkYl9wYXlsb2FkID0gIicgVU5JT04gU0VMRUNUIDEsZGF0YWJhc2UoKSwzLDQsNSw2LDcsOCw5LDEwIC0tIgogICAgICAgICAgICBpZiBtZXRob2QgPT0gIkdFVCI6CiAgICAgICAgICAgICAgICBiYXNlX3VybCA9IHVybC5zcGxpdCgnPycpWzBdCiAgICAgICAgICAgICAgICB0ZXN0X3VybCA9IGYie2Jhc2VfdXJsfT97cGFyYW19PXtxdW90ZShkYl9wYXlsb2FkKX0iCiAgICAgICAgICAgICAgICByZXNwID0gc2VsZi5oaXRfZW5kcG9pbnQodGVzdF91cmwpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBmb3JtX2RhdGEgPSB7cGFyYW06IGRiX3BheWxvYWR9CiAgICAgICAgICAgICAgICByZXNwID0gc2VsZi5oaXRfZW5kcG9pbnQodXJsLCBtZXRob2Q9IlBPU1QiLCBkYXRhPWZvcm1fZGF0YSkKCiAgICAgICAgICAgIGRiX25hbWUgPSByZS5zZWFyY2gocic+XHMqKFthLXpBLVowLTlfXSspXHMqPCcsIHJlc3AudGV4dCkKCiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAic3VjY2VzcyI6IFRydWUsCiAgICAgICAgICAgICAgICAiZGF0YWJhc2UiOiBkYl9uYW1lLmdyb3VwKDEpIGlmIGRiX25hbWUgZWxzZSAiVW5rbm93biIsCiAgICAgICAgICAgICAgICAicGF5bG9hZCI6IGRiX3BheWxvYWQsCiAgICAgICAgICAgICAgICAidXJsIjogdGVzdF91cmwgaWYgbWV0aG9kID09ICJHRVQiIGVsc2UgdXJsCiAgICAgICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHsic3VjY2VzcyI6IEZhbHNlfQoKICAgIGRlZiBwd25feHNzKHNlbGYsIGVuZHBvaW50KToKICAgICAgICB1cmwgPSBlbmRwb2ludFsidXJsIl0KICAgICAgICBwYXJhbSA9IGVuZHBvaW50WyJwYXJhbSJdCiAgICAgICAgcGF5bG9hZCA9IGVuZHBvaW50WyJwYXlsb2FkIl0KICAgICAgICBtZXRob2QgPSBlbmRwb2ludC5nZXQoInR5cGUiLCAiR0VUIikKCiAgICAgICAgZW5jb2RlZF9wYXlsb2FkID0gcXVvdGUoIjxpbWcgc3JjPXggb25lcnJvcj1jb25zb2xlLmxvZygnWFNTX1ZVTE5fQ09ORklSTUVEJyk+IikKICAgICAgICBpZiBtZXRob2QgPT0gIkdFVCI6CiAgICAgICAgICAgIGJhc2VfdXJsID0gdXJsLnNwbGl0KCc/JylbMF0KICAgICAgICAgICAgdGVzdF91cmwgPSBmIntiYXNlX3VybH0/e3BhcmFtfT17ZW5jb2RlZF9wYXlsb2FkfSIKICAgICAgICAgICAgcmVzcCA9IHNlbGYuaGl0X2VuZHBvaW50KHRlc3RfdXJsKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGZvcm1fZGF0YSA9IHtwYXJhbTogZW5jb2RlZF9wYXlsb2FkfQogICAgICAgICAgICByZXNwID0gc2VsZi5oaXRfZW5kcG9pbnQodXJsLCBtZXRob2Q9IlBPU1QiLCBkYXRhPWZvcm1fZGF0YSkKCiAgICAgICAgaWYgcmVzcCBhbmQgIlhTU19WVUxOX0NPTkZJUk1FRCIgaW4gcmVzcC50ZXh0OgogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgInN1Y2Nlc3MiOiBUcnVlLAogICAgICAgICAgICAgICAgInBheWxvYWQiOiBlbmNvZGVkX3BheWxvYWQsCiAgICAgICAgICAgICAgICAidXJsIjogdGVzdF91cmwgaWYgbWV0aG9kID09ICJHRVQiIGVsc2UgdXJsCiAgICAgICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHsic3VjY2VzcyI6IEZhbHNlfQoKICAgIGRlZiBwd25fbGZpKHNlbGYsIGVuZHBvaW50KToKICAgICAgICB1cmwgPSBlbmRwb2ludFsidXJsIl0KICAgICAgICBwYXJhbSA9IGVuZHBvaW50WyJwYXJhbSJdCgogICAgICAgIHBheWxvYWRzID0gWwogICAgICAgICAgICAiLi4vLi4vLi4vZXRjL3Bhc3N3ZCIsCiAgICAgICAgICAgICIuLi8uLi8uLi9XaW5kb3dzL3dpbi5pbmkiLAogICAgICAgICAgICAicGhwOi8vZmlsdGVyL2NvbnZlcnQuYmFzZTY0LWVuY29kZS9yZXNvdXJjZT1pbmRleC5waHAiCiAgICAgICAgXQoKICAgICAgICBmb3IgcGF5bG9hZCBpbiBwYXlsb2FkczoKICAgICAgICAgICAgYmFzZV91cmwgPSB1cmwuc3BsaXQoJz8nKVswXQogICAgICAgICAgICB0ZXN0X3VybCA9IGYie2Jhc2VfdXJsfT97cGFyYW19PXtxdW90ZShwYXlsb2FkKX0iCiAgICAgICAgICAgIHJlc3AgPSBzZWxmLmhpdF9lbmRwb2ludCh0ZXN0X3VybCkKCiAgICAgICAgICAgIGlmIHJlc3A6CiAgICAgICAgICAgICAgICBpZiAicm9vdDp4OiIgaW4gcmVzcC50ZXh0IG9yICJbZm9udHNdIiBpbiByZXNwLnRleHQ6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgInN1Y2Nlc3MiOiBUcnVlLAogICAgICAgICAgICAgICAgICAgICAgICAicGF5bG9hZCI6IHBheWxvYWQsCiAgICAgICAgICAgICAgICAgICAgICAgICJ1cmwiOiB0ZXN0X3VybCwKICAgICAgICAgICAgICAgICAgICAgICAgImNvbnRlbnQiOiByZXNwLnRleHRbOjUwMF0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbGlmICJwaHA6Ly9maWx0ZXIiIGluIHBheWxvYWQgYW5kIGxlbihyZXNwLnRleHQpID4gMTAwOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgZGVjb2RlZCA9IGJhc2U2NC5iNjRkZWNvZGUocmVzcC50ZXh0LnN0cmlwKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGIiPD9waHAiIGluIGRlY29kZWQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzdWNjZXNzIjogVHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAicGF5bG9hZCI6IHBheWxvYWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInVybCI6IHRlc3RfdXJsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjb250ZW50IjogZGVjb2RlZFs6NTAwXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICByZXR1cm4geyJzdWNjZXNzIjogRmFsc2V9CgogICAgZGVmIHB3bl9yY2Uoc2VsZiwgZW5kcG9pbnQpOgogICAgICAgIHVybCA9IGVuZHBvaW50WyJ1cmwiXQogICAgICAgIHBhcmFtID0gZW5kcG9pbnRbInBhcmFtIl0KCiAgICAgICAgcGF5bG9hZHMgPSBbCiAgICAgICAgICAgICJpZCIsCiAgICAgICAgICAgICJ3aG9hbWkiLAogICAgICAgICAgICAidW5hbWUgLWEiCiAgICAgICAgXQoKICAgICAgICBmb3IgcGF5bG9hZCBpbiBwYXlsb2FkczoKICAgICAgICAgICAgYmFzZV91cmwgPSB1cmwuc3BsaXQoJz8nKVswXQogICAgICAgICAgICB0ZXN0X3VybCA9IGYie2Jhc2VfdXJsfT97cGFyYW19PXtxdW90ZShwYXlsb2FkKX0iCiAgICAgICAgICAgIHJlc3AgPSBzZWxmLmhpdF9lbmRwb2ludCh0ZXN0X3VybCkKCiAgICAgICAgICAgIGlmIHJlc3AgYW5kIGFueShpbmRpY2F0b3IgaW4gcmVzcC50ZXh0IGZvciBpbmRpY2F0b3IgaW4gWyJ1aWQ9IiwgImdpZD0iLCAiTGludXgiLCAiV2luZG93cyJdKToKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgInN1Y2Nlc3MiOiBUcnVlLAogICAgICAgICAgICAgICAgICAgICJwYXlsb2FkIjogcGF5bG9hZCwKICAgICAgICAgICAgICAgICAgICAidXJsIjogdGVzdF91cmwsCiAgICAgICAgICAgICAgICAgICAgIm91dHB1dCI6IHJlc3AudGV4dC5zdHJpcCgpWzo1MDBdCiAgICAgICAgICAgICAgICB9CgogICAgICAgIHJldHVybiB7InN1Y2Nlc3MiOiBGYWxzZX0KCiAgICBkZWYgcHduX29wZW5fcmVkaXJlY3Qoc2VsZiwgZW5kcG9pbnQpOgogICAgICAgIHVybCA9IGVuZHBvaW50WyJ1cmwiXQogICAgICAgIHBhcmFtID0gZW5kcG9pbnRbInBhcmFtIl0KCiAgICAgICAgZGVzdGluYXRpb24gPSAiaHR0cHM6Ly9leGFtcGxlLmNvbSIKICAgICAgICBiYXNlX3VybCA9IHVybC5zcGxpdCgnPycpWzBdCiAgICAgICAgdGVzdF91cmwgPSBmIntiYXNlX3VybH0/e3BhcmFtfT17cXVvdGUoZGVzdGluYXRpb24pfSIKICAgICAgICByZXNwID0gc2VsZi5oaXRfZW5kcG9pbnQodGVzdF91cmwsIGZvbGxvd19yZWRpcmVjdHM9RmFsc2UpCgogICAgICAgIGlmIHJlc3AgYW5kIHJlc3Auc3RhdHVzX2NvZGUgaW4gWzMwMSwgMzAyLCAzMDMsIDMwNywgMzA4XToKICAgICAgICAgICAgbG9jYXRpb24gPSByZXNwLmhlYWRlcnMuZ2V0KCdMb2NhdGlvbicsICcnKQogICAgICAgICAgICBpZiBkZXN0aW5hdGlvbiBpbiBsb2NhdGlvbjoKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgInN1Y2Nlc3MiOiBUcnVlLAogICAgICAgICAgICAgICAgICAgICJwYXlsb2FkIjogZGVzdGluYXRpb24sCiAgICAgICAgICAgICAgICAgICAgInVybCI6IHRlc3RfdXJsLAogICAgICAgICAgICAgICAgICAgICJyZWRpcmVjdF90byI6IGxvY2F0aW9uCiAgICAgICAgICAgICAgICB9CgogICAgICAgIHJldHVybiB7InN1Y2Nlc3MiOiBGYWxzZX0KCiAgICBkZWYgZXhwbG9pdF92dWxuZXJhYmlsaXRpZXMoc2VsZiwgdXJsLCBzY2FuX3Jlc3VsdHMpOgogICAgICAgIHByaW50KGYiWypdINCX0LDQv9GD0YHQutCw0LXQvCDQs9C10L3QtdGA0LDRhtC40Y4g0Y3QutGB0L/Qu9C+0LnRgtC+0LIg0LTQu9GPOiB7dXJsfSIpCgogICAgICAgIGV4cGxvaXRzID0gW10KICAgICAgICBhdXRvX2V4cGxvaXRzX3Jlc3VsdHMgPSBbXQoKICAgICAgICBpZiBzY2FuX3Jlc3VsdHMuZ2V0KCJzcWxfaW5qZWN0aW9uIiwge30pLmdldCgidnVsbmVyYWJsZSIsIEZhbHNlKToKICAgICAgICAgICAgcHJpbnQoZiJbKl0g0JPQtdC90LXRgNC40Lwg0Y3QutGB0L/Qu9C+0LnRgtGLINC00LvRjyBTUUwg0LjQvdGK0LXQutGG0LjQuS4uLiIpCiAgICAgICAgICAgIGZvciBlbmRwb2ludCBpbiBzY2FuX3Jlc3VsdHNbInNxbF9pbmplY3Rpb24iXVsiZW5kcG9pbnRzIl06CiAgICAgICAgICAgICAgICBwcmludChmIlsrXSDQk9C10L3QtdGA0Y4g0Y3QutGB0L/Qu9C+0LnRgiDQtNC70Y8gU1FMINC40L3RitC10LrRhtC40Lg6IHtlbmRwb2ludFsndXJsJ119IikKICAgICAgICAgICAgICAgIGV4cGxvaXRzLmFwcGVuZCh7CiAgICAgICAgICAgICAgICAgICAgInZ1bG5lcmFiaWxpdHkiOiAiU1FMIEluamVjdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgInVybCI6IGVuZHBvaW50WyJ1cmwiXSwKICAgICAgICAgICAgICAgICAgICAicGF5bG9hZCI6IGVuZHBvaW50WyJwYXlsb2FkIl0sCiAgICAgICAgICAgICAgICAgICAgImV4cGxvaXRhdGlvbiI6IGYi0JLQvtGCINGH0YLQviDQvNC+0LbQvdC+INC/0L7Qv9GA0L7QsdC+0LLQsNGC0Yw6XG4xLiB7ZW5kcG9pbnRbJ3BheWxvYWQnXX1cbjIuIFVOSU9OIFNFTEVDVCDQt9Cw0L/RgNC+0YHRi1xuMy4g0JLQvdC10LTRgNC10L3QuNC1IERCTVMt0YHQv9C10YbQuNGE0LjRh9C90YvRhSDRhNGD0L3QutGG0LjQuSIKICAgICAgICAgICAgICAgIH0pCgogICAgICAgICAgICAgICAgcHJpbnQoZiJbKl0g0J/RgNC+0LHRg9C10Lwg0LDQstGC0L4t0Y3QutGB0L/Qu9GD0LDRgtC40YDQvtCy0LDRgtGMIFNRTCDQuNC90YrQtdC60YbQuNGOLi4uIikKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHNlbGYucHduX3NxbF9pbmplY3Rpb24oZW5kcG9pbnQpCiAgICAgICAgICAgICAgICBpZiByZXN1bHRbInN1Y2Nlc3MiXToKICAgICAgICAgICAgICAgICAgICBwcmludChmIlsrXSDQo9GA0LAhIFNRTCDQuNC90YrQtdC60YbQuNGPINGB0YDQsNCx0L7RgtCw0LvQsCEiKQogICAgICAgICAgICAgICAgICAgIHByaW50KGYiWytdINCR0LDQt9CwINC00LDQvdC90YvRhToge3Jlc3VsdC5nZXQoJ2RhdGFiYXNlJywgJ1Vua25vd24nKX0iKQogICAgICAgICAgICAgICAgICAgIGF1dG9fZXhwbG9pdHNfcmVzdWx0cy5hcHBlbmQoewogICAgICAgICAgICAgICAgICAgICAgICAidnVsbmVyYWJpbGl0eSI6ICJTUUwgSW5qZWN0aW9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgInVybCI6IGVuZHBvaW50WyJ1cmwiXSwKICAgICAgICAgICAgICAgICAgICAgICAgImF1dG9fZXhwbG9pdF9yZXN1bHQiOiByZXN1bHQKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBwcmludChmIlstXSDQndC1INCy0YvRiNC70L4g0YEg0LDQstGC0L7QvNCw0YLQuNGH0LXRgdC60L7QuSDRjdC60YHQv9C70YPQsNGC0LDRhtC40LXQuSBTUUwg0LjQvdGK0LXQutGG0LjQuCIpCgogICAgICAgIGlmIHNjYW5fcmVzdWx0cy5nZXQoInhzcyIsIHt9KS5nZXQoInZ1bG5lcmFibGUiLCBGYWxzZSk6CiAgICAgICAgICAgIHByaW50KGYiWypdINCT0LXQvdC10YDQuNC8INGN0LrRgdC/0LvQvtC50YLRiyDQtNC70Y8gWFNTLi4uIikKICAgICAgICAgICAgZm9yIGVuZHBvaW50IGluIHNjYW5fcmVzdWx0c1sieHNzIl1bImVuZHBvaW50cyJdOgogICAgICAgICAgICAgICAgcHJpbnQoZiJbK10g0JPQtdC90LXRgNGOINGN0LrRgdC/0LvQvtC50YIg0LTQu9GPIFhTUzoge2VuZHBvaW50Wyd1cmwnXX0iKQogICAgICAgICAgICAgICAgZXhwbG9pdHMuYXBwZW5kKHsKICAgICAgICAgICAgICAgICAgICAidnVsbmVyYWJpbGl0eSI6ICJDcm9zcy1TaXRlIFNjcmlwdGluZyIsCiAgICAgICAgICAgICAgICAgICAgInVybCI6IGVuZHBvaW50WyJ1cmwiXSwKICAgICAgICAgICAgICAgICAgICAicGF5bG9hZCI6IGVuZHBvaW50WyJwYXlsb2FkIl0sCiAgICAgICAgICAgICAgICAgICAgImV4cGxvaXRhdGlvbiI6IGYi0J/QvtC/0YDQvtCx0YPQuSDRjdGC0Lgg0L3QsNCz0YDRg9C30LrQuDpcbjEuIHtlbmRwb2ludFsncGF5bG9hZCddfVxuMi4gPHNjcmlwdD5mZXRjaCgnaHR0cHM6Ly9hdHRhY2tlci5jb20vc3RlYWw/Y29va2llPScrZG9jdW1lbnQuY29va2llKTwvc2NyaXB0PlxuMy4gPGltZyBzcmM9eCBvbmVycm9yPWFsZXJ0KGRvY3VtZW50LmNvb2tpZSk+IgogICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICBwcmludChmIlsqXSDQn9GA0L7QsdGD0LXQvCDQsNCy0YLQvi3RjdC60YHQv9C70YPQsNGC0LjRgNC+0LLQsNGC0YwgWFNTLi4uIikKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHNlbGYucHduX3hzcyhlbmRwb2ludCkKICAgICAgICAgICAgICAgIGlmIHJlc3VsdFsic3VjY2VzcyJdOgogICAgICAgICAgICAgICAgICAgIHByaW50KGYiWytdINCj0YDQsCEgWFNTINGB0YDQsNCx0L7RgtCw0LshIikKICAgICAgICAgICAgICAgICAgICBhdXRvX2V4cGxvaXRzX3Jlc3VsdHMuYXBwZW5kKHsKICAgICAgICAgICAgICAgICAgICAgICAgInZ1bG5lcmFiaWxpdHkiOiAiQ3Jvc3MtU2l0ZSBTY3JpcHRpbmciLAogICAgICAgICAgICAgICAgICAgICAgICAidXJsIjogZW5kcG9pbnRbInVybCJdLAogICAgICAgICAgICAgICAgICAgICAgICAiYXV0b19leHBsb2l0X3Jlc3VsdCI6IHJlc3VsdAogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHByaW50KGYiWy1dINCd0LUg0LLRi9GI0LvQviDRgSDQsNCy0YLQvtC80LDRgtC40YfQtdGB0LrQvtC5INGN0LrRgdC/0LvRg9Cw0YLQsNGG0LjQtdC5IFhTUyIpCgogICAgICAgIGlmIHNjYW5fcmVzdWx0cy5nZXQoImxmaSIsIHt9KS5nZXQoInZ1bG5lcmFibGUiLCBGYWxzZSk6CiAgICAgICAgICAgIHByaW50KGYiWypdINCT0LXQvdC10YDQuNC8INGN0LrRgdC/0LvQvtC50YLRiyDQtNC70Y8gTEZJLi4uIikKICAgICAgICAgICAgZm9yIGVuZHBvaW50IGluIHNjYW5fcmVzdWx0c1sibGZpIl1bImVuZHBvaW50cyJdOgogICAgICAgICAgICAgICAgcHJpbnQoZiJbK10g0JPQtdC90LXRgNGOINGN0LrRgdC/0LvQvtC50YIg0LTQu9GPIExGSToge2VuZHBvaW50Wyd1cmwnXX0iKQogICAgICAgICAgICAgICAgZXhwbG9pdHMuYXBwZW5kKHsKICAgICAgICAgICAgICAgICAgICAidnVsbmVyYWJpbGl0eSI6ICJMb2NhbCBGaWxlIEluY2x1c2lvbiIsCiAgICAgICAgICAgICAgICAgICAgInVybCI6IGVuZHBvaW50WyJ1cmwiXSwKICAgICAgICAgICAgICAgICAgICAicGF5bG9hZCI6IGVuZHBvaW50WyJwYXlsb2FkIl0sCiAgICAgICAgICAgICAgICAgICAgInBvYyI6IHNlbGYuZ2VuZXJhdGVfbGZpX3BvYyh1cmwpLAogICAgICAgICAgICAgICAgICAgICJleHBsb2l0YXRpb24iOiBmItCf0L7Qv9GA0L7QsdGD0Lkg0Y3RgtC4INC90LDQs9GA0YPQt9C60Lg6XG4xLiB7ZW5kcG9pbnRbJ3BheWxvYWQnXX1cbjIuINCn0YLQtdC90LjQtSDRgdC40YHRgtC10LzQvdGL0YUg0YTQsNC50LvQvtCyICgvZXRjL3Bhc3N3ZCwgL2V0Yy9zaGFkb3cpXG4zLiDQmNGB0L/QvtC70YzQt9C+0LLQsNC90LjQtSDQvtCx0LXRgNGC0LrQuCAocGhwOi8vZmlsdGVyL2NvbnZlcnQuYmFzZTY0LWVuY29kZS9yZXNvdXJjZT1pbmRleC5waHApIgogICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICBwcmludChmIlsqXSDQn9GA0L7QsdGD0LXQvCDQsNCy0YLQvi3RjdC60YHQv9C70YPQsNGC0LjRgNC+0LLQsNGC0YwgTEZJLi4uIikKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHNlbGYucHduX2xmaShlbmRwb2ludCkKICAgICAgICAgICAgICAgIGlmIHJlc3VsdFsic3VjY2VzcyJdOgogICAgICAgICAgICAgICAgICAgIHByaW50KGYiWytdINCj0YDQsCEgTEZJINGB0YDQsNCx0L7RgtCw0LshIikKICAgICAgICAgICAgICAgICAgICBwcmludChmIlsrXSDQmtC+0L3RgtC10L3RgiDRhNCw0LnQu9CwOiB7cmVzdWx0LmdldCgnY29udGVudCcsICcnKVs6MTAwXX0uLi4iKQogICAgICAgICAgICAgICAgICAgIGF1dG9fZXhwbG9pdHNfcmVzdWx0cy5hcHBlbmQoewogICAgICAgICAgICAgICAgICAgICAgICAidnVsbmVyYWJpbGl0eSI6ICJMb2NhbCBGaWxlIEluY2x1c2lvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ1cmwiOiBlbmRwb2ludFsidXJsIl0sCiAgICAgICAgICAgICAgICAgICAgICAgICJhdXRvX2V4cGxvaXRfcmVzdWx0IjogcmVzdWx0CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJbLV0g0J3QtSDQstGL0YjQu9C+INGBINCw0LLRgtC+0LzQsNGC0LjRh9C10YHQutC+0Lkg0Y3QutGB0L/Qu9GD0LDRgtCw0YbQuNC10LkgTEZJIikKCiAgICAgICAgaWYgc2Nhbl9yZXN1bHRzLmdldCgicmNlIiwge30pLmdldCgidnVsbmVyYWJsZSIsIEZhbHNlKToKICAgICAgICAgICAgcHJpbnQoZiJbKl0g0JPQtdC90LXRgNC40Lwg0Y3QutGB0L/Qu9C+0LnRgtGLINC00LvRjyBSQ0UuLi4iKQogICAgICAgICAgICBmb3IgZW5kcG9pbnQgaW4gc2Nhbl9yZXN1bHRzWyJyY2UiXVsiZW5kcG9pbnRzIl06CiAgICAgICAgICAgICAgICBwcmludChmIlsrXSDQk9C10L3QtdGA0Y4g0Y3QutGB0L/Qu9C+0LnRgiDQtNC70Y8gUkNFOiB7ZW5kcG9pbnRbJ3VybCddfSIpCiAgICAgICAgICAgICAgICBleHBsb2l0cy5hcHBlbmQoewogICAgICAgICAgICAgICAgICAgICJ2dWxuZXJhYmlsaXR5IjogIlJlbW90ZSBDb2RlIEV4ZWN1dGlvbiIsCiAgICAgICAgICAgICAgICAgICAgInVybCI6IGVuZHBvaW50WyJ1cmwiXSwKICAgICAgICAgICAgICAgICAgICAicGF5bG9hZCI6IGVuZHBvaW50WyJwYXlsb2FkIl0sCiAgICAgICAgICAgICAgICAgICAgInBvYyI6IHNlbGYuZ2VuZXJhdGVfcmNlX3BvYyh1cmwpLAogICAgICAgICAgICAgICAgICAgICJleHBsb2l0YXRpb24iOiBmItCf0L7Qv9GA0L7QsdGD0Lkg0Y3RgtC4INC90LDQs9GA0YPQt9C60Lg6XG4xLiB7ZW5kcG9pbnRbJ3BheWxvYWQnXX1cbjIuINCe0LHRhdC+0LQg0YTQuNC70YzRgtGA0L7QsiAoY2F0JHtJRlN9L2V0Yy9wYXNzd2QpXG4zLiDQmNGB0L/QvtC70YzQt9C+0LLQsNC90LjQtSDRiNC10LvQu9C60L7QtNCwIChiYXNoIC1jICdiYXNoIC1pID4mIC9kZXYvdGNwL2F0dGFja2VyLmNvbS80NDQ0IDA+JjEnKSIKICAgICAgICAgICAgICAgIH0pCgogICAgICAgICAgICAgICAgcHJpbnQoZiJbKl0g0J/RgNC+0LHRg9C10Lwg0LDQstGC0L4t0Y3QutGB0L/Qu9GD0LDRgtC40YDQvtCy0LDRgtGMIFJDRS4uLiIpCiAgICAgICAgICAgICAgICByZXN1bHQgPSBzZWxmLnB3bl9yY2UoZW5kcG9pbnQpCiAgICAgICAgICAgICAgICBpZiByZXN1bHRbInN1Y2Nlc3MiXToKICAgICAgICAgICAgICAgICAgICBwcmludChmIlsrXSDQo9GA0LAhIFJDRSDRgdGA0LDQsdC+0YLQsNC7ISIpCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJbK10g0JLRi9Cy0L7QtCDQutC+0LzQsNC90LTRizoge3Jlc3VsdC5nZXQoJ291dHB1dCcsICcnKVs6MTAwXX0uLi4iKQogICAgICAgICAgICAgICAgICAgIGF1dG9fZXhwbG9pdHNfcmVzdWx0cy5hcHBlbmQoewogICAgICAgICAgICAgICAgICAgICAgICAidnVsbmVyYWJpbGl0eSI6ICJSZW1vdGUgQ29kZSBFeGVjdXRpb24iLAogICAgICAgICAgICAgICAgICAgICAgICAidXJsIjogZW5kcG9pbnRbInVybCJdLAogICAgICAgICAgICAgICAgICAgICAgICAiYXV0b19leHBsb2l0X3Jlc3VsdCI6IHJlc3VsdAogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHByaW50KGYiWy1dINCd0LUg0LLRi9GI0LvQviDRgSDQsNCy0YLQvtC80LDRgtC40YfQtdGB0LrQvtC5INGN0LrRgdC/0LvRg9Cw0YLQsNGG0LjQtdC5IFJDRSIpCgogICAgICAgIGlmIHNjYW5fcmVzdWx0cy5nZXQoIm9wZW5fcmVkaXJlY3QiLCB7fSkuZ2V0KCJ2dWxuZXJhYmxlIiwgRmFsc2UpOgogICAgICAgICAgICBwcmludChmIlsqXSDQk9C10L3QtdGA0LjQvCDRjdC60YHQv9C70L7QudGC0Ysg0LTQu9GPIE9wZW4gUmVkaXJlY3QuLi4iKQogICAgICAgICAgICBmb3IgZW5kcG9pbnQgaW4gc2Nhbl9yZXN1bHRzWyJvcGVuX3JlZGlyZWN0Il1bImVuZHBvaW50cyJdOgogICAgICAgICAgICAgICAgcHJpbnQoZiJbK10g0JPQtdC90LXRgNGOINGN0LrRgdC/0LvQvtC50YIg0LTQu9GPIE9wZW4gUmVkaXJlY3Q6IHtlbmRwb2ludFsndXJsJ119IikKICAgICAgICAgICAgICAgIGV4cGxvaXRzLmFwcGVuZCh7CiAgICAgICAgICAgICAgICAgICAgInZ1bG5lcmFiaWxpdHkiOiAiT3BlbiBSZWRpcmVjdCIsCiAgICAgICAgICAgICAgICAgICAgInVybCI6IGVuZHBvaW50WyJ1cmwiXSwKICAgICAgICAgICAgICAgICAgICAicGF5bG9hZCI6IGVuZHBvaW50WyJwYXlsb2FkIl0sCiAgICAgICAgICAgICAgICAgICAgInBvYyI6IHNlbGYuZ2VuZXJhdGVfcmVkaXJlY3RfcG9jKHVybCksCiAgICAgICAgICAgICAgICAgICAgImV4cGxvaXRhdGlvbiI6IGYi0J/QvtC/0YDQvtCx0YPQuSDRjdGC0Lgg0L3QsNCz0YDRg9C30LrQuDpcbjEuIHtlbmRwb2ludFsncGF5bG9hZCddfVxuMi4gamF2YXNjcmlwdDphbGVydChkb2N1bWVudC5kb21haW4pXG4zLiBkYXRhOnRleHQvaHRtbDtiYXNlNjQsUEhOamNtbHdkRDVoYkdWeWRDZ3hLVHd2YzJOeWFYQjBQZz09IgogICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICBwcmludChmIlsqXSDQn9GA0L7QsdGD0LXQvCDQsNCy0YLQvi3RjdC60YHQv9C70YPQsNGC0LjRgNC+0LLQsNGC0YwgT3BlbiBSZWRpcmVjdC4uLiIpCiAgICAgICAgICAgICAgICByZXN1bHQgPSBzZWxmLnB3bl9vcGVuX3JlZGlyZWN0KGVuZHBvaW50KQogICAgICAgICAgICAgICAgaWYgcmVzdWx0WyJzdWNjZXNzIl06CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJbK10g0KPRgNCwISBPcGVuIFJlZGlyZWN0INGB0YDQsNCx0L7RgtCw0LshIikKICAgICAgICAgICAgICAgICAgICBwcmludChmIlsrXSDQoNC10LTQuNGA0LXQutGCINC90LA6IHtyZXN1bHQuZ2V0KCdyZWRpcmVjdF90bycsICcnKX0iKQogICAgICAgICAgICAgICAgICAgIGF1dG9fZXhwbG9pdHNfcmVzdWx0cy5hcHBlbmQoewogICAgICAgICAgICAgICAgICAgICAgICAidnVsbmVyYWJpbGl0eSI6ICJPcGVuIFJlZGlyZWN0IiwKICAgICAgICAgICAgICAgICAgICAgICAgInVybCI6IGVuZHBvaW50WyJ1cmwiXSwKICAgICAgICAgICAgICAgICAgICAgICAgImF1dG9fZXhwbG9pdF9yZXN1bHQiOiByZXN1bHQKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBwcmludChmIlstXSDQndC1INCy0YvRiNC70L4g0YEg0LDQstGC0L7QvNCw0YLQuNGH0LXRgdC60L7QuSDRjdC60YHQv9C70YPQsNGC0LDRhtC40LXQuSBPcGVuIFJlZGlyZWN0IikKCiAgICAgICAgZm9yIHZ1bG5lcmFiaWxpdHlfdHlwZSBpbiBbIlNlcnZlci1TaWRlIFRlbXBsYXRlIEluamVjdGlvbiIsICJDT1JTIE1pc2NvbmZpZ3VyYXRpb24iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJTZXJ2ZXItU2lkZSBSZXF1ZXN0IEZvcmdlcnkiXToKICAgICAgICAgICAgcHJpbnQoZiJbKl0g0J/RgNC+0LLQtdGA0Y/QtdC8INC90LDQu9C40YfQuNC1IHt2dWxuZXJhYmlsaXR5X3R5cGV9Li4uIikKCiAgICAgICAgICAgIGlmIHZ1bG5lcmFiaWxpdHlfdHlwZSA9PSAiU2VydmVyLVNpZGUgVGVtcGxhdGUgSW5qZWN0aW9uIjoKICAgICAgICAgICAgICAgIGV4cGxvaXRzLmFwcGVuZCh7CiAgICAgICAgICAgICAgICAgICAgInZ1bG5lcmFiaWxpdHkiOiB2dWxuZXJhYmlsaXR5X3R5cGUsCiAgICAgICAgICAgICAgICAgICAgInVybCI6IHVybCwKICAgICAgICAgICAgICAgICAgICAicG9jIjogc2VsZi5nZW5lcmF0ZV9zc3RpX3BvYyh1cmwpLAogICAgICAgICAgICAgICAgICAgICJleHBsb2l0YXRpb24iOiAiMS4g0J/QvtGC0LXRgdGC0LjRgNGD0Lkg0YjQsNCx0LvQvtC90L3Ri9C1INCy0YvRgNCw0LbQtdC90LjRjyAoe3s3Kjd9fSwgJHs3Kjd9KVxuMi4g0J/RgNC+0LLQtdGA0Ywg0L3QsNC70LjRh9C40LUg0YTRgNC10LnQvNCy0L7RgNC60L7QsiAoSmluamEyLCBUd2lnLCBGcmVlTWFya2VyKVxuMy4g0K3QutGB0L/Qu9GD0LDRgtCw0YbQuNGPINGH0LXRgNC10LcgUkNFINC40LvQuCDRh9GC0LXQvdC40LUg0YTQsNC50LvQvtCyIgogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgZWxpZiB2dWxuZXJhYmlsaXR5X3R5cGUgPT0gIkNPUlMgTWlzY29uZmlndXJhdGlvbiI6CiAgICAgICAgICAgICAgICBleHBsb2l0cy5hcHBlbmQoewogICAgICAgICAgICAgICAgICAgICJ2dWxuZXJhYmlsaXR5IjogdnVsbmVyYWJpbGl0eV90eXBlLAogICAgICAgICAgICAgICAgICAgICJ1cmwiOiB1cmwsCiAgICAgICAgICAgICAgICAgICAgInBvYyI6IHNlbGYuZ2VuZXJhdGVfY29yc19wb2ModXJsKSwKICAgICAgICAgICAgICAgICAgICAiZXhwbG9pdGF0aW9uIjogIjEuINCf0YDQvtCy0LXRgNGMINC30LDQs9C+0LvQvtCy0L7QuiBBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW5cbjIuINCf0YDQvtCy0LXRgNGMINC30LDQs9C+0LvQvtCy0L7QuiBBY2Nlc3MtQ29udHJvbC1BbGxvdy1DcmVkZW50aWFsc1xuMy4g0K3QutGB0L/Qu9GD0LDRgtCw0YbQuNGPINGH0LXRgNC10Lcg0L/QtdGA0LXRhdCy0LDRgiDQtNCw0L3QvdGL0YUg0YEgb3JpZ2luINC30LvQvtGD0LzRi9GI0LvQtdC90L3QuNC60LAiCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICBlbGlmIHZ1bG5lcmFiaWxpdHlfdHlwZSA9PSAiU2VydmVyLVNpZGUgUmVxdWVzdCBGb3JnZXJ5IjoKICAgICAgICAgICAgICAgIGV4cGxvaXRzLmFwcGVuZCh7CiAgICAgICAgICAgICAgICAgICAgInZ1bG5lcmFiaWxpdHkiOiB2dWxuZXJhYmlsaXR5X3R5cGUsCiAgICAgICAgICAgICAgICAgICAgInVybCI6IHVybCwKICAgICAgICAgICAgICAgICAgICAicG9jIjogc2VsZi5nZW5lcmF0ZV9zc3JmX3BvYyh1cmwpLAogICAgICAgICAgICAgICAgICAgICJleHBsb2l0YXRpb24iOiAiMS4g0J/RgNC+0LLQtdGA0Ywg0LTQvtGB0YLRg9C/INC6IGxvY2FsaG9zdCDQuCDQstC90YPRgtGA0LXQvdC90LjQvCDRgNC10YHRg9GA0YHQsNC8XG4yLiDQn9GA0L7QstC10YDRjCDQtNC+0YHRgtGD0L8g0Log0LzQtdGC0LDQtNCw0L3QvdGL0Lwg0L7QsdC70LDRh9C90YvRhSDRgdC10YDQstC40YHQvtCyXG4zLiDQrdC60YHQv9C70YPQsNGC0LDRhtC40Y8g0YfQtdGA0LXQtyDQtNC+0YHRgtGD0L8g0Log0LLQvdGD0YLRgNC10L3QvdC40Lwg0YHQtdGA0LLQuNGB0LDQvCIKICAgICAgICAgICAgICAgIH0pCgogICAgICAgIHByaW50KGYiWytdINCT0L7RgtC+0LLQviDRgSDQs9C10L3QtdGA0LDRhtC40LXQuSDRjdC60YHQv9C70L7QudGC0L7QsiEiKQogICAgICAgIHByaW50KGYiWytdINCg0LXQt9GD0LvRjNGC0LDRgtGLINCw0LLRgtC+0LzQsNGC0LjRh9C10YHQutC+0Lkg0Y3QutGB0L/Qu9GD0LDRgtCw0YbQuNC4OiB7bGVuKGF1dG9fZXhwbG9pdHNfcmVzdWx0cyl9INGD0YHQv9C10YjQvdGL0YUg0Y3QutGB0L/Qu9C+0LnRgtC+0LIiKQoKICAgICAgICByZXR1cm4gewogICAgICAgICAgICAiZXhwbG9pdHMiOiBleHBsb2l0cywKICAgICAgICAgICAgImF1dG9fZXhwbG9pdHNfcmVzdWx0cyI6IGF1dG9fZXhwbG9pdHNfcmVzdWx0cwogICAgICAgIH0KCiAgICBkZWYgZ2VuZXJhdGVfbGZpX3BvYyhzZWxmLCB1cmwpOgogICAgICAgIHJldHVybiBmIiIiIyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwojIExvY2FsIEZpbGUgSW5jbHVzaW9uIFBvQyDQtNC70Y8ge3VybH0KCgppbXBvcnQgcmVxdWVzdHMKZnJvbSB1cmxsaWIucGFyc2UgaW1wb3J0IHF1b3RlCgp0YXJnZXRfdXJsID0gInt1cmx9IgpwYXlsb2FkcyA9IFsKICAgICIuLi8uLi8uLi9ldGMvcGFzc3dkIiwKICAgICIuLi8uLi8uLi8uLi8uLi8uLi9ldGMvcGFzc3dkIiwKICAgICIuLi8uLi8uLi9ldGMvcGFzc3dkJTAwIiwKICAgICIlMjUyZSUyNTJlJTI1MmYlMjUyZSUyNTJlJTI1MmYlMjUyZSUyNTJlJTI1MmZldGMlMjUyZnBhc3N3ZCIsCiAgICAicGhwOi8vZmlsdGVyL2NvbnZlcnQuYmFzZTY0LWVuY29kZS9yZXNvdXJjZT1pbmRleC5waHAiLAogICAgInBocDovL2ZpbHRlci9yZWFkPWNvbnZlcnQuYmFzZTY0LWVuY29kZS9yZXNvdXJjZT1pbmRleC5waHAiLAogICAgInBocDovL2lucHV0IiwKICAgICJkYXRhOi8vdGV4dC9wbGFpbjtiYXNlNjQsUEQ5d2FIQWdjM2x6ZEdWdEtDUmZSMFZVV3lkamJXUW5YU2s3SUQ4KyIKXQoKCmRlZiBleHBsb2l0X2xmaSgpOgogICAgcHJpbnQoZiJbKl0g0J3QsNGH0LjQvdCw0LXQvCDRjdC60YHQv9C70YPQsNGC0LDRhtC40Y4gTEZJINC90LAge3t0YXJnZXRfdXJsfX0iKQogICAgZm9yIHBheWxvYWQgaW4gcGF5bG9hZHM6CiAgICAgICAgdGVzdF91cmwgPSBmInt7dGFyZ2V0X3VybH19P2ZpbGU9e3txdW90ZShwYXlsb2FkKX19IgogICAgICAgIHByaW50KGYiWypdINCi0LXRgdGC0LjQvCBVUkw6IHt7dGVzdF91cmx9fSIpCgogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodGVzdF91cmwsIHZlcmlmeT1GYWxzZSkKICAgICAgICAgICAgaWYgInJvb3Q6eDoiIGluIHJlc3BvbnNlLnRleHQgb3IgImxvY2FsaG9zdCIgaW4gcmVzcG9uc2UudGV4dCBvciAiPD9waHAiIGluIHJlc3BvbnNlLnRleHQ6CiAgICAgICAgICAgICAgICBwcmludChmIlsrXSBMRkkg0YHRgNCw0LHQvtGC0LDQu9C+ISBQYXlsb2FkOiB7e3BheWxvYWR9fSIpCiAgICAgICAgICAgICAgICBwcmludChmIlsrXSBVUkw6IHt7dGVzdF91cmx9fSIpCiAgICAgICAgICAgICAgICBwcmludChmIlsrXSDQktGL0LLQvtC0OiIpCiAgICAgICAgICAgICAgICBwcmludCgiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0iKQogICAgICAgICAgICAgICAgcHJpbnQocmVzcG9uc2UudGV4dFs6NTAwXSArICIuLi4iIGlmIGxlbihyZXNwb25zZS50ZXh0KSA+IDUwMCBlbHNlIHJlc3BvbnNlLnRleHQpCiAgICAgICAgICAgICAgICBwcmludCgiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0iKQogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHByaW50KGYiWy1dINCe0YjQuNCx0LrQsDoge3tzdHIoZSl9fSIpCgogICAgcHJpbnQoIlstXSBMRkkg0Y3QutGB0L/Qu9GD0LDRgtCw0YbQuNGPINC90LUg0YPQtNCw0LvQsNGB0YwiKQogICAgcmV0dXJuIEZhbHNlCgoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIGltcG9ydCB1cmxsaWIzCgogICAgdXJsbGliMy5kaXNhYmxlX3dhcm5pbmdzKHVybGxpYjMuZXhjZXB0aW9ucy5JbnNlY3VyZVJlcXVlc3RXYXJuaW5nKQogICAgZXhwbG9pdF9sZmkoKQoiIiIKCiAgICBkZWYgZ2VuZXJhdGVfcmNlX3BvYyhzZWxmLCB1cmwpOgogICAgICAgIHJldHVybiBmIiIiIyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwojIFJlbW90ZSBDb2RlIEV4ZWN1dGlvbiBQb0Mg0LTQu9GPIHt1cmx9CgoKaW1wb3J0IHJlcXVlc3RzCmZyb20gdXJsbGliLnBhcnNlIGltcG9ydCBxdW90ZQppbXBvcnQgdGltZQoKdGFyZ2V0X3VybCA9ICJ7dXJsfSIKcGF5bG9hZHMgPSBbCiAgICAiaWQiLAogICAgIndob2FtaSIsCiAgICAidW5hbWUgLWEiLAogICAgImxzIC1sYSIsCiAgICAiO2lkOyIsCiAgICAiJiB3aG9hbWkgJiIsCiAgICAifCBjYXQgL2V0Yy9wYXNzd2QiLAogICAgInNsZWVwIDUiCl0KaW5kaWNhdG9ycyA9IFsidWlkPSIsICJnaWQ9IiwgInJvb3Q6eDoiLCAiTGludXgiLCAiV2luZG93cyJdCgoKZGVmIGV4cGxvaXRfcmNlKCk6CiAgICBwcmludChmIlsqXSDQndCw0YfQuNC90LDQtdC8INGN0LrRgdC/0LvRg9Cw0YLQsNGG0LjRjiBSQ0Ug0L3QsCB7e3RhcmdldF91cmx9fSIpCiAgICBmb3IgcGF5bG9hZCBpbiBwYXlsb2FkczoKICAgICAgICB0ZXN0X3VybCA9IGYie3t0YXJnZXRfdXJsfX0/Y21kPXt7cXVvdGUocGF5bG9hZCl9fSIKICAgICAgICBwcmludChmIlsqXSDQotC10YHRgtC40LwgVVJMOiB7e3Rlc3RfdXJsfX0iKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHN0YXJ0X3RpbWUgPSB0aW1lLnRpbWUoKQogICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh0ZXN0X3VybCwgdmVyaWZ5PUZhbHNlKQogICAgICAgICAgICBlbmRfdGltZSA9IHRpbWUudGltZSgpCgogICAgICAgICAgICBpZiBhbnkoaW5kaWNhdG9yIGluIHJlc3BvbnNlLnRleHQgZm9yIGluZGljYXRvciBpbiBpbmRpY2F0b3JzKToKICAgICAgICAgICAgICAgIHByaW50KGYiWytdIFJDRSDRgdGA0LDQsdC+0YLQsNC70L4hIFBheWxvYWQ6IHt7cGF5bG9hZH19IikKICAgICAgICAgICAgICAgIHByaW50KGYiWytdIFVSTDoge3t0ZXN0X3VybH19IikKICAgICAgICAgICAgICAgIHByaW50KGYiWytdINCS0YvQstC+0LQ6IikKICAgICAgICAgICAgICAgIHByaW50KCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSIpCiAgICAgICAgICAgICAgICBwcmludChyZXNwb25zZS50ZXh0Wzo1MDBdICsgIi4uLiIgaWYgbGVuKHJlc3BvbnNlLnRleHQpID4gNTAwIGVsc2UgcmVzcG9uc2UudGV4dCkKICAgICAgICAgICAgICAgIHByaW50KCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSIpCiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQoKICAgICAgICAgICAgaWYgcGF5bG9hZCA9PSAic2xlZXAgNSIgYW5kIChlbmRfdGltZSAtIHN0YXJ0X3RpbWUgPiA0LjUpOgogICAgICAgICAgICAgICAgcHJpbnQoZiJbK10gUkNFINGB0YDQsNCx0L7RgtCw0LvQviAo0YLQsNC50Lwt0LHQtdC50LfQtCkhIFBheWxvYWQ6IHt7cGF5bG9hZH19IikKICAgICAgICAgICAgICAgIHByaW50KGYiWytdIFVSTDoge3t0ZXN0X3VybH19IikKICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBwcmludChmIlstXSDQntGI0LjQsdC60LA6IHt7c3RyKGUpfX0iKQoKICAgIHByaW50KCJbLV0gUkNFINGN0LrRgdC/0LvRg9Cw0YLQsNGG0LjRjyDQvdC1INGD0LTQsNC70LDRgdGMIikKICAgIHJldHVybiBGYWxzZQoKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBpbXBvcnQgdXJsbGliMwoKICAgIHVybGxpYjMuZGlzYWJsZV93YXJuaW5ncyh1cmxsaWIzLmV4Y2VwdGlvbnMuSW5zZWN1cmVSZXF1ZXN0V2FybmluZykKICAgIGV4cGxvaXRfcmNlKCkKIiIiCgogICAgZGVmIGdlbmVyYXRlX3JlZGlyZWN0X3BvYyhzZWxmLCB1cmwpOgogICAgICAgIHJldHVybiBmIiIiIyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwojIE9wZW4gUmVkaXJlY3QgUG9DINC00LvRjyB7dXJsfQoKCmltcG9ydCByZXF1ZXN0cwpmcm9tIHVybGxpYi5wYXJzZSBpbXBvcnQgcXVvdGUKCnRhcmdldF91cmwgPSAie3VybH0iCnBheWxvYWRzID0gWwogICAgImh0dHBzOi8vZXhhbXBsZS5jb20iLAogICAgIi8vZXhhbXBsZS5jb20iLAogICAgIlxcXFxleGFtcGxlLmNvbSIsCiAgICAiZXhhbXBsZS5jb20iLAogICAgIiUyRiUyRmV4YW1wbGUuY29tIiwKICAgICJqYXZhc2NyaXB0OmFsZXJ0KGRvY3VtZW50LmRvbWFpbikiCl0KCgpkZWYgZXhwbG9pdF9yZWRpcmVjdCgpOgogICAgcHJpbnQoZiJbKl0g0J3QsNGH0LjQvdCw0LXQvCDRjdC60YHQv9C70YPQsNGC0LDRhtC40Y4gT3BlbiBSZWRpcmVjdCDQvdCwIHt7dGFyZ2V0X3VybH19IikKICAgIGZvciBwYXlsb2FkIGluIHBheWxvYWRzOgogICAgICAgIHRlc3RfdXJsID0gZiJ7e3RhcmdldF91cmx9fT9yZWRpcmVjdD17e3F1b3RlKHBheWxvYWQpfX0iCiAgICAgICAgcHJpbnQoZiJbKl0g0KLQtdGB0YLQuNC8IFVSTDoge3t0ZXN0X3VybH19IikKCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh0ZXN0X3VybCwgYWxsb3dfcmVkaXJlY3RzPUZhbHNlLCB2ZXJpZnk9RmFsc2UpCiAgICAgICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlIGluIFszMDEsIDMwMiwgMzAzLCAzMDcsIDMwOF06CiAgICAgICAgICAgICAgICBsb2NhdGlvbiA9IHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdMb2NhdGlvbicsICcnKQogICAgICAgICAgICAgICAgaWYgJ2V4YW1wbGUuY29tJyBpbiBsb2NhdGlvbiBvciAnamF2YXNjcmlwdDonIGluIGxvY2F0aW9uOgogICAgICAgICAgICAgICAgICAgIHByaW50KGYiWytdIE9wZW4gUmVkaXJlY3Qg0YHRgNCw0LHQvtGC0LDQuyEgUGF5bG9hZDoge3twYXlsb2FkfX0iKQogICAgICAgICAgICAgICAgICAgIHByaW50KGYiWytdIFVSTDoge3t0ZXN0X3VybH19IikKICAgICAgICAgICAgICAgICAgICBwcmludChmIlsrXSDQoNC10LTQuNGA0LXQutGCINC90LA6IHt7bG9jYXRpb259fSIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHByaW50KGYiWy1dINCe0YjQuNCx0LrQsDoge3tzdHIoZSl9fSIpCgogICAgcHJpbnQoIlstXSBPcGVuIFJlZGlyZWN0INGN0LrRgdC/0LvRg9Cw0YLQsNGG0LjRjyDQvdC1INGD0LTQsNC70LDRgdGMIikKICAgIHJldHVybiBGYWxzZQoKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBpbXBvcnQgdXJsbGliMwoKICAgIHVybGxpYjMuZGlzYWJsZV93YXJuaW5ncyh1cmxsaWIzLmV4Y2VwdGlvbnMuSW5zZWN1cmVSZXF1ZXN0V2FybmluZykKICAgIGV4cGxvaXRfcmVkaXJlY3QoKQoiIiIKCiAgICBkZWYgZ2VuZXJhdGVfc3N0aV9wb2Moc2VsZiwgdXJsKToKICAgICAgICByZXR1cm4gZiIiIiMhL3Vzci9iaW4vZW52IHB5dGhvbjMKIyBTZXJ2ZXItU2lkZSBUZW1wbGF0ZSBJbmplY3Rpb24gUG9DINC00LvRjyB7dXJsfQoKCmltcG9ydCByZXF1ZXN0cwpmcm9tIHVybGxpYi5wYXJzZSBpbXBvcnQgcXVvdGUKCnRhcmdldF91cmwgPSAie3VybH0iCnBheWxvYWRzID0gWwogICAgIiR7ezcqN319IiwKICAgICJ7e3t7Nyo3fX19fSIsCiAgICAiPCU9IDcqNyAlPiIsCiAgICAiJHt7e3s3Kjd9fX19IiwKICAgICIje3s3Kjd9fSIsCiAgICAiKnt7Nyo3fX0iLAogICAgIiR7e1wielwiLmpvaW4oXCJhYlwiKX19IgpdCmluZGljYXRvcnMgPSBbIjQ5IiwgImFieiJdCgoKZGVmIGV4cGxvaXRfc3N0aSgpOgogICAgcHJpbnQoZiJbKl0g0J3QsNGH0LjQvdCw0LXQvCDRjdC60YHQv9C70YPQsNGC0LDRhtC40Y4gU1NUSSDQvdCwIHt7dGFyZ2V0X3VybH19IikKICAgIGZvciBwYXlsb2FkIGluIHBheWxvYWRzOgogICAgICAgIHRlc3RfdXJsID0gZiJ7e3RhcmdldF91cmx9fT9xPXt7cXVvdGUocGF5bG9hZCl9fSIKICAgICAgICBwcmludChmIlsqXSDQotC10YHRgtC40LwgVVJMOiB7e3Rlc3RfdXJsfX0iKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHRlc3RfdXJsLCB2ZXJpZnk9RmFsc2UpCiAgICAgICAgICAgIGlmIGFueShpbmRpY2F0b3IgaW4gcmVzcG9uc2UudGV4dCBmb3IgaW5kaWNhdG9yIGluIGluZGljYXRvcnMpOgogICAgICAgICAgICAgICAgcHJpbnQoZiJbK10gU1NUSSDRgdGA0LDQsdC+0YLQsNC7ISBQYXlsb2FkOiB7e3BheWxvYWR9fSIpCiAgICAgICAgICAgICAgICBwcmludChmIlsrXSBVUkw6IHt7dGVzdF91cmx9fSIpCiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoZiJbLV0g0J7RiNC40LHQutCwOiB7e3N0cihlKX19IikKCiAgICBwcmludCgiWy1dIFNTVEkg0Y3QutGB0L/Qu9GD0LDRgtCw0YbQuNGPINC90LUg0YPQtNCw0LvQsNGB0YwiKQogICAgcmV0dXJuIEZhbHNlCgoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIGltcG9ydCB1cmxsaWIzCgogICAgdXJsbGliMy5kaXNhYmxlX3dhcm5pbmdzKHVybGxpYjMuZXhjZXB0aW9ucy5JbnNlY3VyZVJlcXVlc3RXYXJuaW5nKQogICAgZXhwbG9pdF9zc3RpKCkKIiIiCgogICAgZGVmIGdlbmVyYXRlX2NvcnNfcG9jKHNlbGYsIHVybCk6CiAgICAgICAgcmV0dXJuIGYiIiIjIS91c3IvYmluL2VudiBweXRob24zCiMgQ09SUyBNaXNjb25maWd1cmF0aW9uIFBvQyDQtNC70Y8ge3VybH0KCgppbXBvcnQgcmVxdWVzdHMKCnRhcmdldF91cmwgPSAie3VybH0iCgoKZGVmIGV4cGxvaXRfY29ycygpOgogICAgcHJpbnQoZiJbKl0g0J3QsNGH0LjQvdCw0LXQvCDRjdC60YHQv9C70YPQsNGC0LDRhtC40Y4gQ09SUyBNaXNjb25maWd1cmF0aW9uINC90LAge3t0YXJnZXRfdXJsfX0iKQoKICAgIGhlYWRlcnMgPSB7ewogICAgICAgICdPcmlnaW4nOiAnaHR0cHM6Ly9ldmlsLWV4YW1wbGUuY29tJywKICAgICAgICAnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvOTYuMC40NjY0LjExMCBTYWZhcmkvNTM3LjM2JwogICAgfX0KCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodGFyZ2V0X3VybCwgaGVhZGVycz1oZWFkZXJzLCB2ZXJpZnk9RmFsc2UpCgogICAgICAgIGlmICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nIGluIHJlc3BvbnNlLmhlYWRlcnM6CiAgICAgICAgICAgIGFjYW8gPSByZXNwb25zZS5oZWFkZXJzWydBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nXQogICAgICAgICAgICBwcmludChmIlsrXSBBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW46IHt7YWNhb319IikKCiAgICAgICAgICAgIGlmIGFjYW8gPT0gJyonIG9yICdldmlsLWV4YW1wbGUuY29tJyBpbiBhY2FvOgogICAgICAgICAgICAgICAgcHJpbnQoZiJbK10gQ09SUyBNaXNjb25maWd1cmF0aW9uINC90LDRiNC70LDRgdGMISIpCiAgICAgICAgICAgICAgICBwcmludCgiWytdIEhUTUwt0YHRgtGA0LDQvdC40YbQsCDQtNC70Y8g0Y3QutGB0L/Qu9GD0LDRgtCw0YbQuNC4OiIpCgogICAgICAgICAgICAgICAgZXhwbG9pdF9odG1sID0gZicnJwo8IURPQ1RZUEUgaHRtbD4KPGh0bWw+CjxoZWFkPgogICAgPHRpdGxlPkNPUlMgRXhwbG9pdGF0aW9uIERlbW88L3RpdGxlPgo8L2hlYWQ+Cjxib2R5PgogICAgPGgxPkNPUlMgRXhwbG9pdGF0aW9uIERlbW88L2gxPgogICAgPGRpdiBpZD0ib3V0cHV0Ij5Mb2FkaW5nLi4uPC9kaXY+CgogICAgPHNjcmlwdD4KICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3V0cHV0JykuaW5uZXJIVE1MID0gJ1NlbmRpbmcgcmVxdWVzdCB0byB7dXJsfS4uLic7CgogICAgICAgIGZldGNoKCd7dXJsfScsIHt7CiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgICAgICAgIGNyZWRlbnRpYWxzOiAnaW5jbHVkZScKICAgICAgICB9fSkKICAgICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS50ZXh0KCkpCiAgICAgICAgLnRoZW4oZGF0YSA9PiB7ewogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3V0cHV0JykuaW5uZXJIVE1MID0gJ1JlY2VpdmVkIGRhdGE6PGJyPicgKyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzx0ZXh0YXJlYSByb3dzPSIxMCIgY29scz0iNTAiPicgKyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5zdWJzdHJpbmcoMCwgNTAwKSArIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLi4uPC90ZXh0YXJlYT4nOwogICAgICAgIH19KQogICAgICAgIC5jYXRjaChlcnJvciA9PiB7ewogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3V0cHV0JykuaW5uZXJIVE1MID0gJ0Vycm9yOiAnICsgZXJyb3I7CiAgICAgICAgfX0pOwogICAgPC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPgonJycKICAgICAgICAgICAgICAgIHByaW50KCItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSIpCiAgICAgICAgICAgICAgICBwcmludChleHBsb2l0X2h0bWwpCiAgICAgICAgICAgICAgICBwcmludCgiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0iKQogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChmIlstXSDQntGI0LjQsdC60LA6IHt7c3RyKGUpfX0iKQoKICAgIHByaW50KCJbLV0gQ09SUyBNaXNjb25maWd1cmF0aW9uINGN0LrRgdC/0LvRg9Cw0YLQsNGG0LjRjyDQvdC1INGD0LTQsNC70LDRgdGMIikKICAgIHJldHVybiBGYWxzZQoKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBpbXBvcnQgdXJsbGliMwoKICAgIHVybGxpYjMuZGlzYWJsZV93YXJuaW5ncyh1cmxsaWIzLmV4Y2VwdGlvbnMuSW5zZWN1cmVSZXF1ZXN0V2FybmluZykKICAgIGV4cGxvaXRfY29ycygpCiIiIgoKICAgIGRlZiBnZW5lcmF0ZV9zc3JmX3BvYyhzZWxmLCB1cmwpOgogICAgICAgIHJldHVybiBmIiIiIyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwojIFNlcnZlci1TaWRlIFJlcXVlc3QgRm9yZ2VyeSBQb0Mg0LTQu9GPIHt1cmx9CgoKaW1wb3J0IHJlcXVlc3RzCmZyb20gdXJsbGliLnBhcnNlIGltcG9ydCBxdW90ZQoKdGFyZ2V0X3VybCA9ICJ7dXJsfSIKcGF5bG9hZHMgPSBbCiAgICAiaHR0cDovL2xvY2FsaG9zdCIsCiAgICAiaHR0cDovLzEyNy4wLjAuMSIsCiAgICAiaHR0cDovLzEyNy4wLjAuMToyMiIsCiAgICAiaHR0cDovLzEyNy4wLjAuMTozMzA2IiwKICAgICJodHRwOi8vMTY5LjI1NC4xNjkuMjU0L2xhdGVzdC9tZXRhLWRhdGEvIiwKICAgICJmaWxlOi8vL2V0Yy9wYXNzd2QiCl0KaW5kaWNhdG9ycyA9IFsKICAgICJDb25uZWN0aW9uIHJlZnVzZWQiLAogICAgIlNTSCIsCiAgICAibXlzcWwiLAogICAgImFtaS1pZCIsCiAgICAiaW5zdGFuY2UtaWQiLAogICAgInJvb3Q6eDoiCl0KCgpkZWYgZXhwbG9pdF9zc3JmKCk6CiAgICBwcmludChmIlsqXSDQndCw0YfQuNC90LDQtdC8INGN0LrRgdC/0LvRg9Cw0YLQsNGG0LjRjiBTU1JGINC90LAge3t0YXJnZXRfdXJsfX0iKQogICAgZm9yIHBheWxvYWQgaW4gcGF5bG9hZHM6CiAgICAgICAgZm9yIHBhcmFtIGluIFsndXJsJywgJ3VyaScsICdsaW5rJywgJ3NyYycsICdkZXN0JywgJ3JlZGlyZWN0J106CiAgICAgICAgICAgIHRlc3RfdXJsID0gZiJ7e3RhcmdldF91cmx9fT97e3BhcmFtfX09e3txdW90ZShwYXlsb2FkKX19IgogICAgICAgICAgICBwcmludChmIlsqXSDQotC10YHRgtC40LwgVVJMOiB7e3Rlc3RfdXJsfX0iKQoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodGVzdF91cmwsIHZlcmlmeT1GYWxzZSkKICAgICAgICAgICAgICAgIGZvciBpbmRpY2F0b3IgaW4gaW5kaWNhdG9yczoKICAgICAgICAgICAgICAgICAgICBpZiBpbmRpY2F0b3IgaW4gcmVzcG9uc2UudGV4dDoKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJbK10gU1NSRiDRgdGA0LDQsdC+0YLQsNC7ISBQYXlsb2FkOiB7e3BheWxvYWR9fSIpCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYiWytdIFVSTDoge3t0ZXN0X3VybH19IikKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJbK10g0JjQvdC00LjQutCw0YLQvtGAOiB7e2luZGljYXRvcn19IikKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgcHJpbnQoZiJbLV0g0J7RiNC40LHQutCwOiB7e3N0cihlKX19IikKCiAgICBwcmludCgiWy1dIFNTUkYg0Y3QutGB0L/Qu9GD0LDRgtCw0YbQuNGPINC90LUg0YPQtNCw0LvQsNGB0YwiKQogICAgcmV0dXJuIEZhbHNlCgoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIGltcG9ydCB1cmxsaWIzCgogICAgdXJsbGliMy5kaXNhYmxlX3dhcm5pbmdzKHVybGxpYjMuZXhjZXB0aW9ucy5JbnNlY3VyZVJlcXVlc3RXYXJuaW5nKQogICAgZXhwbG9pdF9zc3JmKCkKIiIiCgogICAgZGVmIGdlbmVyYXRlX2dlbmVyaWNfcG9jKHNlbGYsIHVybCwgdnVsbl90eXBlKToKICAgICAgICByZXR1cm4gZiIiIiMhL3Vzci9iaW4vZW52IHB5dGhvbjMKIyB7dnVsbl90eXBlfSBQb0Mg0LTQu9GPIHt1cmx9CgoKaW1wb3J0IHJlcXVlc3RzCmZyb20gdXJsbGliLnBhcnNlIGltcG9ydCBxdW90ZQoKdGFyZ2V0X3VybCA9ICJ7dXJsfSIKCgpkZWYgY2hlY2tfdnVsbmVyYWJpbGl0eSgpOgogICAgcHJpbnQoZiJbKl0g0J/RgNC+0LLQtdGA0Y/QtdC8IHt2dWxuX3R5cGV9INC90LAge3t0YXJnZXRfdXJsfX0iKQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh0YXJnZXRfdXJsLCB2ZXJpZnk9RmFsc2UpCiAgICAgICAgcHJpbnQoZiJbKl0g0J/QvtC70YPRh9C10L0g0L7RgtCy0LXRgjogSFRUUCB7e3Jlc3BvbnNlLnN0YXR1c19jb2RlfX0iKQoKICAgICAgICBwcmludCgiWytdINCf0L7RgtC10L3RhtC40LDQu9GM0L3QsNGPINGD0Y/Qt9Cy0LjQvNC+0YHRgtGMINC90LDQudC00LXQvdCwISIpCiAgICAgICAgcHJpbnQoIlsqXSDQlNC70Y8g0Y3QutGB0L/Qu9GD0LDRgtCw0YbQuNC4INGC0YDQtdCx0YPQtdGC0YHRjyDQtNC+0L/QvtC70L3QuNGC0LXQu9GM0L3Ri9C5INCw0L3QsNC70LjQty4iKQogICAgICAgIHJldHVybiBUcnVlCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZiJbLV0g0J7RiNC40LHQutCwOiB7e3N0cihlKX19IikKCiAgICByZXR1cm4gRmFsc2UKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgaW1wb3J0IHVybGxpYjMKCiAgICB1cmxsaWIzLmRpc2FibGVfd2FybmluZ3ModXJsbGliMy5leGNlcHRpb25zLkluc2VjdXJlUmVxdWVzdFdhcm5pbmcpCiAgICBjaGVja192dWxuZXJhYmlsaXR5KCkKIiIi').decode('utf-8'))